---
title: Автоматическая проверка подлинности в Trezor Suite
weight: 8
date: 2025-04-21
---

В приложении Trezor Suite есть несколько важных механизмов для проверки подлинности аппаратных кошельков, включая прошивку. Эти проверки производятся автоматически и неочевидны для пользователя. Кроме того, могут наблюдаться ложные срабатывания системы защиты.

> Вы можете проверить ваш Trezor One вручную, в том числе недоступными в Trezor Suite методами. Подробнее см. в руководстве: [Проверка подлинности Trezor One](trezor/trezor-one-check).

## Проверка ревизии прошивки

> Помимо десктопного приложения Trezor Suite, данная проверка осуществляется и в мобильном приложении [Trezor Suite Lite](https://trezor.io/learn/a/what-is-trezor-suite-lite) для Android.

Проверка подлинности прошивки предназначена для дополнительной защиты от поддельных устройств Trezor. Такие устройства появляются время от времени (в основном в неавторизованных интернет-магазинах), и эта дополнительная "проверка подлинности" должна отлавливать наиболее продвинутые поддельные устройства, находящиеся в обороте.

### Как работает проверка подлинности прошивки?

Каждый бинарный файл прошивки имеет несколько свойств, включая версию прошивки и атрибут RevisionID. Эти свойства хранятся в Trezor Suite, а также на удаленном сервере (в репозитории [Data](https://github.com/trezor/data/)). Это означает, что приложению известны все выпущенные версии прошивки (плюс их ревизии).

Устройство Trezor передает эти свойства в приложение Trezor Suite, и они сверяются с базой данных версий, хранящейся в приложении. Если эти атрибуты совпадают, то ничего не происходит, и вы можете продолжать пользоваться Trezor и приложением Suite как обычно. Однако, если они не совпадают, Trezor Suite отобразит следующее предупреждение:

{{% image src="img/trezor/trezor-suite-checks-1.webp" %}}
Возможно, ваше устройство было взломано. Проверка ревизии прошивки устройства не удалась.
{{% /image %}}

На этом этапе доступ к Trezor Suite фактически "заблокирован", вы можете лишь нажать кнопку **Contact Trezor Support**, чтобы обратиться в техническую поддержку производителя.
 
Поскольку база данных хранится в приложении Trezor Suite, эта проверка происходит, даже если приложение находится в офлайн-режиме. Есть несколько различных сценариев проверки прошивки:

#### Сценарий 1: Trezor Suite находится _онлайн_ и версия прошивки устройства _присутствует_ в локальной базе данных

- **Версия прошивки** и **RevisionID** на устройстве Trezor **<font color="green">соответствуют</font>** тем, что хранятся в базе данных Trezor Suite: **<font color="green">OK</font>**.

- **Версия прошивки** и **RevisionID** на устройстве **<font color="red">не совпадают</font>** с теми, что хранятся в базе данных Trezor Suite: **<font color="red">Suite "блокируется" и отображается предупреждение</font>**.

#### Сценарий 2: Trezor Suite находится _онлайн_ и версия прошивки устройства _отсутствует_ в локальной базе данных

- Trezor Suite ищет удаленную базу данных в репозитории Data и проверяет ее; **версия прошивки** и **RevisionID** на устройстве **<font color="green">соответствуют</font>** тем, что хранятся в базе данных: **<font color="green">OK</font>**.

- Trezor Suite ищет удаленную базу данных в репозитории Data и проверяет ее; **версия прошивки** и **RevisionID** на устройстве **<font color="red">не совпадают</font>** с теми, что хранятся в базе данных: **<font color="red">Suite "блокируется" и отображается предупреждение</font>**.

#### Сценарий 3: Trezor Suite находится _офлайн_ и версия прошивки устройства _присутствует_ в локальной базе данных

- **Версия прошивки** и **RevisionID** на устройстве Trezor **<font color="green">соответствуют</font>** тем, что хранятся в базе данных Trezor Suite: **<font color="green">OK</font>**.

- **Версия прошивки** и **RevisionID** на устройстве **<font color="red">не совпадают</font>** с теми, что хранятся в базе данных Trezor Suite: **<font color="red">Suite "блокируется" и отображается предупреждение</font>**.

#### Сценарий 4: Trezor Suite находится _офлайн_ и версия прошивки устройства _отсутствует_ в локальной базе данных

- Trezor Suite проверяет локальную базу данных, и **версия прошивки** в ней не хранится; удаленная база данных не может быть загружена (Suite находится в офлайн-режиме), поэтому отображается баннер в верхней части экрана:

{{% image src="img/trezor/trezor-suite-checks-2.webp" %}}
Проверка прошивки не может быть выполнена. Чтобы проверить ревизию прошивки, подключитесь к интернету.
{{% /image %}}

- После подключения к сети баннер исчезает; Suite ищет удаленную базу данных в репозитории Data и проверяет ее; **версия прошивки** и **RevisionID** на устройстве **<font color="green">соответствуют</font>** тем, что хранятся в базе данных: **<font color="green">OK</font>**.
- Trezor Suite ищет удаленную базу данных в репозитории Data и проверяет ее; **версия прошивки** и **RevisionID** на устройстве **<font color="red">не совпадают</font>** с теми, что хранятся в базе данных: **<font color="red">Suite "блокируется" и отображается предупреждение</font>**.

### Отключение проверки подлинности прошивки

Проверку подлинности прошивки можно включить/выключить через **Настройки > Устройство > Опасная зона**:
 
{{% image src="img/trezor/trezor-suite-checks-3.webp" /%}}

Эту проверку безопасности следует отключать только в целях тестирования и разработки (с прошивкой, которая еще не выпущена).

## Проверка хэш-суммы прошивки

Начиная с версии Trezor Suite 24.11.2, была введена дополнительная мера безопасности, чтобы защитить пользователей Trezor от поддельных или неавторизованных прошивок. Отныне при каждом подключении устройства Trezor к компьютеру оно будет проходить **проверку хэш-суммы прошивки**.
 
Проверка хэш-суммы прошивки выполняется одновременно с проверкой ревизии прошивки, но это два разных процесса. **Проверка ревизии прошивки** проверяет, что прошивка устройства является официальной и актуальной, а **проверка хэша прошивки** проверяет, что прошивка не была изменена или подделана. Для простоты Trezor Suite объединяет их под одной настройкой “Firmware authenticity check”.  
 
### Что нового в Trezor Suite 24.11.2

Ранее проверка хэш-суммы прошивки выполнялась только во время установки или обновления прошивки. Если обнаруживалось несоответствие хэш-суммы, Suite определял устройство как подделку и выводил на экран постоянный предупреждающий баннер.

В Trezor Suite 24.11.2 проверка хэш-суммы прошивки выполняется _также_ при каждом подключении устройства Trezor.

**Условия для выполнения проверки хэш-суммы прошивки**:

- Если версия прошивки, хранящейся в Trezor Suite, совпадает с версией на устройстве, проверка будет выполнена.
- Если версии прошивок отличаются (например, если прошивка устройства устарела), проверка будет пропущена.

В десктопном приложении Trezor Suite проверка выполняется только в том случае, если устройство обновлено до последней версии прошивки, предлагаемой приложением. Однако [веб-приложение Trezor Suite](https://suite.trezor.io/web/) выполняет проверку хэш-суммы для всех прошивок Trezor One версии ≥1.11, поскольку автоматически загружает бинарный файл нужной прошивки, и версии ≥2.6.0 для всех остальных устройств.
 
### Уведомления безопасности: предупреждающий экран и баннеры

Если проверка хэш-суммы обнаруживает несоответствие прошивки, Trezor Suite выводит предупреждающий экран, который сообщает пользователю, что его устройство может быть взломано или на нем установлена неофициальная прошивка. После того как пользователь закрывает предупреждение, на экране остается **предупреждающий баннер**, подчеркивающий потенциальную угрозу безопасности. Сообщение предупреждающего баннера может отличаться в зависимости от того, была ли проблема обнаружена в результате проверки ревизии прошивки или проверки хэш-суммы прошивки.
 
### Как работает проверка хэш-суммы прошивки?

При каждом подключении устройства Trezor приложение Trezor Suite выполняет проверку прошивки устройства.

Вот краткое описание процесса:

1. **Проверка соответствия**: Trezor Suite отправляет устройству случайный криптографический вызов. Затем устройство вычисляет хэш-сумму прошивки, используя случайное число, полученное от Suite. Результат сравнивается с хэш-суммой, вычисленной с использованием того же случайного числа из официального бинарного файла прошивки, хранящегося в Trezor Suite.
2. **Если совпадает**: Устройство проверено, и вы можете использовать его как обычно.
3. **Если не совпадает**: Trezor Suite помечает устройство как потенциально опасное, отображает экран предупреждения и ограничивает некоторые функции. Уведомление в виде баннера остается видимым.

Эта проверка также выполняется при установке или обновлении прошивки, что позволяет постоянно поддерживать безопасность устройства.

Проверяя прошивку при каждом подключении устройства, Trezor Suite защищает пользователей от поддельных и взломанных прошивок, гарантируя, что на устройстве установлена только подлинная, безопасная прошивка. Этот процесс автоматизирован и работает в фоновом режиме.

## Проверка энтропии

> Проверка энтропии работает на **всех моделях Trezor Safe** и **Trezor T**. Она **не поддерживается** для Trezor One. Однако, вы можете произвести проверку энтропии для Trezor One [вручную](trezor/trezor-one-check/#%D1%82%D0%B5%D1%81%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5-%D0%B3%D0%B5%D0%BD%D0%B5%D1%80%D0%B0%D1%86%D0%B8%D0%B8-%D1%81%D0%B8%D0%B4-%D1%84%D1%80%D0%B0%D0%B7%D1%8B).

При первоначальной настройке Trezor **проверка энтропии** гарантирует, что сид-фраза вашего кошелька будет сгенерирована случайным образом.
  
Trezor Suite проверяет, действительно ли случайные данные (энтропия), используемые для создания вашего кошелька, непредсказуемы и целостны. Если проверка не удается, Trezor Suite блокирует доступ к кошельку, чтобы вы не потеряли свои средства.
  
Хотя и редко, но некоторые пользователи, приобретающие Trezor у **неавторизованных реселлеров**, могут неосознанно получить устройство, которое не генерирует действительно случайные сид-фразы. Проверка энтропии снижает этот риск: если обнаружится, что устройство неправильно обрабатывает случайность, Trezor Suite заблокирует доступ к кошельку.
 
> Проверка энтропии **не** защищает от всех видов поддельных или взломанных устройств. Она направлена на устройства, генерирующие неслучайные сид-фразы.

### Как работает проверка энтропии?

При каждом запуске проверки энтропии Trezor Suite создает, а затем удаляет кошелек и генерирует новый. Проверяя случайность каждого вновь созданного кошелька, Trezor Suite определяет, действительно ли устройство генерирует случайные кошельки.

Проверка энтропии выполняется следующим образом.

1. **Создание кошелька:** Когда вы настраиваете Trezor, он генерирует кошелек, используя случайные данные (**энтропию**) из самого устройства и из Trezor Suite, чтобы обеспечить непредсказуемость.

2. **Удаление кошелька:** После создания кошелька Trezor **удаляет его** и отправляет использованную энтропию в Trezor Suite.

3. **Восстановление кошелька:** Trezor Suite восстанавливает кошелек из своей энтропии, которая была использована на шаге 1, и энтропии, предоставленной устройством на шаге 2, чтобы проверить, создаются ли точно такие же **XPUB** (расширенные открытые ключи), как и на аппаратном кошельке. **Этот процесс не подвергает риску ни один приватный ключ, поскольку каждый кошелек, созданный во время тестирования, удаляется и никогда не используется — он существует на устройстве лишь короткое время для проверки энтропии**.

4. **Сравнение:** Если ключи XPUB из обоих кошельков совпадают, устройство считается подлинным. Если не совпадают, устройство может быть поддельным или скомпрометированным.

5. **Случайные проверки:** Suite повторяет этот процесс **от 1 до 5 раз в случайном порядке**, чтобы злоумышленникам было сложнее им манипулировать.

6. **Кошелек проверен:** После того как завершится процесс проверки, Trezor Suite убедится, что ваш кошелек обладает приемлемой степенью энтропии, и позволит вам использовать ваше устройство для создания кошелька, который вы сможете использовать в Trezor Suite.

7. **Что произойдет в случае неудачной проверки?** Если кошельки не совпадают, Trezor Suite блокирует доступ и не позволяет вам использовать кошелек. Если проверка энтропии не удалась, вы увидите следующее всплывающее окно в Trezor Suite:

{{% image src="img/trezor/trezor-suite-checks-4.webp" %}}
Возможно, ваше устройство было взломано. Проверка энтропии не удалась при создании кошелька.
{{% /image %}}

Вы можете нажать кнопку **Contact Trezor Support**, чтобы обратиться в техническую поддержку производителя.

### Почему проверка энтропии может не сработать?

Если проверка энтропии не удалась, это означает, что устройство генерирует кошельки, которые **не являются случайными**. 
  
Криптографическая безопасность основана на высокой степени случайности, которую практически невозможно воспроизвести или эмулировать.
  
Неудачная проверка энтропии означает, что устройство является поддельным и создает неслучайные кошельки, предназначенные для кражи ваших средств.

## Проверка подлинности устройства

Аппаратные кошельки **Trezor Safe 3** и **Safe 5** имеют дополнительный безопасный чип ([Secure Element](https://trezor.io/learn/a/secure-element-in-trezor-safe-devices)). Помимо обеспечения еще одного уровня защиты от физических атак, этот чип играет важную роль в проверке подлинности устройства.

> Как показало [исследование](trezor/trezor-safe-test/#%D1%86%D0%B5%D0%BB%D0%BE%D1%81%D1%82%D0%BD%D0%BE%D1%81%D1%82%D1%8C-%D0%BF%D1%80%D0%BE%D1%88%D0%B8%D0%B2%D0%BA%D0%B8--%D0%B2%D0%B7%D0%B3%D0%BB%D1%8F%D0%B4-%D0%B0%D1%82%D0%B0%D0%BA%D1%83%D1%8E%D1%89%D0%B5%D0%B3%D0%BE) Ledger Donjon фактически проверяется подлинность безопасного чипа, а не всего устройства.
 
### Как работает проверка подлинности устройства?

В процессе производства аппаратных кошельков Trezor Safe новому устройству выдается уникальный сертификат, прежде чем оно сойдет с производственной линии. Этот сертификат хранится в безопасном чипе. При первоначальной настройке устройства:
 
1. Trezor Suite генерирует случайный криптографический вызов, который затем отправляется на устройство Trezor.
2. После этого Secure Element подписывает этот случайный вызов своим приватным ключом и возвращает как подписанный вызов, так и сертификат устройства, который подписан Satoshi Labs и содержит публичный ключ из Secure Element.
3. Trezor Suite проверяет подпись в сертификате с помощью публичного ключа производителя, а также подлинность подписи в вызове с помощью публичного ключа устройства, полученного из сертификата.

В процессе аутентификации **сертификат устройства проверяется исключительно Trezor Suite**, после чего **сразу же удаляется**. Важно отметить, что этот **сертификат никогда не отправляется куда-либо еще** и Trezor Suite не хранит никаких его частей.

Этот процесс помогает проверить подлинность Trezor Safe 3 / Safe 5 и значительно усложняет его подделку.

### Обязательна ли проверка подлинности устройства?

Если вы используете Trezor Suite только с официальными устройствами Trezor, **не отключайте эту проверку**. Эта функция — мера безопасности, призванная защитить вас от возможного использования поддельного или взломанного устройства. Пользователи могут отказаться от процесса проверки подлинности устройства, но Satoshi Labs настоятельно рекомендуют этого не делать.  

> Проверку подлинности следует отключать только в том случае, если вам нужно подключать к Trezor Suite неофициальные устройства, например, DIY-сборки.

Если вы абсолютно уверены, что хотите отключить функцию проверки устройства, вы можете сделать это в меню **Настройки** > **Устройство** > **Опасная зона** > **Выключить проверку устройства**.

### Существуют ли какие-либо проблемы с приватностью, связанные с проверкой подлинности?

Нет, поскольку сертификат устройства нигде не отслеживается и не хранится. Он проверяется **только программой Trezor Suite**, а затем сразу же удаляется. Он никуда не передается, а значит, ваша приватность остается неприкосновенной.